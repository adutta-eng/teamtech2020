{"ast":null,"code":"import { select, event } from 'd3-selection';\nimport { scaleLinear, scaleSqrt } from 'd3-scale';\nimport { hierarchy, partition } from 'd3-hierarchy';\nimport { arc } from 'd3-shape';\nimport { path } from 'd3-path';\nimport { interpolate } from 'd3-interpolate';\nimport { transition } from 'd3-transition';\nimport Kapsule from 'kapsule';\nimport accessorFn from 'accessor-fn';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".sunburst-viz .slice path {\\n  cursor: pointer;\\n}\\n\\n.sunburst-viz text {\\n  font-family: sans-serif;\\n  font-size: 12px;\\n  dominant-baseline: middle;\\n  text-anchor: middle;\\n  pointer-events: none;\\n  fill: #222;\\n}\\n\\n.sunburst-viz text .text-contour {\\n  fill: none;\\n  stroke: white;\\n  stroke-width: 5;\\n  stroke-linejoin: 'round';\\n}\\n\\n.sunburst-viz .main-arc {\\n  stroke: white;\\n  stroke-width: 1px;\\n  transition: opacity .4s;\\n}\\n\\n.sunburst-viz .main-arc:hover {\\n  opacity: 0.85;\\n  transition: opacity .05s;\\n}\\n\\n.sunburst-viz .hidden-arc {\\n  fill: none;\\n}\\n\\n.sunburst-tooltip {\\n  display: none;\\n  position: absolute;\\n  max-width: 320px;\\n  white-space: nowrap;\\n  padding: 5px;\\n  border-radius: 3px;\\n  font: 12px sans-serif;\\n  color: #eee;\\n  background: rgba(0,0,0,0.65);\\n  pointer-events: none;\\n}\\n\\n.sunburst-tooltip .tooltip-title {\\n  font-weight: bold;\\n  text-align: center;\\n  margin-bottom: 5px;\\n}\\n\";\nstyleInject(css_248z);\nvar TRANSITION_DURATION = 750;\nvar CHAR_PX = 6;\nvar sunburst = Kapsule({\n  props: {\n    width: {\n      \"default\": window.innerWidth\n    },\n    height: {\n      \"default\": window.innerHeight\n    },\n    data: {\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    children: {\n      \"default\": 'children',\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    sort: {\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    label: {\n      \"default\": function _default(d) {\n        return d.name;\n      }\n    },\n    size: {\n      \"default\": 'value',\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    color: {\n      \"default\": function _default(d) {\n        return 'lightgrey';\n      }\n    },\n    minSliceAngle: {\n      \"default\": .2\n    },\n    maxLevels: {},\n    showLabels: {\n      \"default\": true\n    },\n    tooltipContent: {\n      \"default\": function _default(d) {\n        return '';\n      },\n      triggerUpdate: false\n    },\n    tooltipTitle: {\n      \"default\": null,\n      triggerUpdate: false\n    },\n    showTooltip: {\n      \"default\": function _default(d) {\n        return true;\n      },\n      triggerUpdate: false\n    },\n    focusOnNode: {\n      onChange: function onChange(d, state) {\n        if (d && state.initialised) {\n          moveStackToFront(d.__dataNode);\n        }\n\n        function moveStackToFront(elD) {\n          state.svg.selectAll('.slice').filter(function (d) {\n            return d === elD;\n          }).each(function (d) {\n            this.parentNode.appendChild(this);\n\n            if (d.parent) {\n              moveStackToFront(d.parent);\n            }\n          });\n        }\n      }\n    },\n    excludeRoot: {\n      \"default\": false,\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    onClick: {\n      triggerUpdate: false\n    },\n    onHover: {\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    _parseData: function _parseData(state) {\n      if (state.data) {\n        var hierData = hierarchy(state.data, accessorFn(state.children)).sum(accessorFn(state.size));\n\n        if (state.sort) {\n          hierData.sort(state.sort);\n        }\n\n        partition().padding(0)(hierData);\n\n        if (state.excludeRoot) {\n          // re-scale y values if excluding root\n          var yScale = scaleLinear().domain([hierData.y1 - hierData.y0, 1]);\n          hierData.descendants().forEach(function (d) {\n            d.y0 = yScale(d.y0);\n            d.y1 = yScale(d.y1);\n          });\n        }\n\n        hierData.descendants().forEach(function (d, i) {\n          d.id = i; // Mark each node with a unique ID\n\n          d.data.__dataNode = d; // Dual-link data nodes\n        });\n        state.layoutData = hierData.descendants();\n      }\n    }\n  },\n  aliases: {\n    onNodeClick: 'onClick'\n  },\n  init: function init(domNode, state) {\n    var _this = this;\n\n    state.chartId = Math.round(Math.random() * 1e12); // Unique ID for DOM elems\n\n    state.radiusScale = scaleSqrt();\n    state.angleScale = scaleLinear().domain([0, 10]) // For initial build-in animation\n    .range([0, 2 * Math.PI]).clamp(true);\n    state.arc = arc().startAngle(function (d) {\n      return state.angleScale(d.x0);\n    }).endAngle(function (d) {\n      return state.angleScale(d.x1);\n    }).innerRadius(function (d) {\n      return Math.max(0, state.radiusScale(d.y0));\n    }).outerRadius(function (d) {\n      return Math.max(0, state.radiusScale(d.y1));\n    });\n    var el = select(domNode).append('div').attr('class', 'sunburst-viz');\n    state.svg = el.append('svg');\n    state.canvas = state.svg.append('g'); // tooltips\n\n    state.tooltip = select('body').append('div').attr('class', 'sunburst-tooltip'); // tooltip cleanup on unmount\n\n    domNode.addEventListener('DOMNodeRemoved', function (e) {\n      if (e.target === this) {\n        state.tooltip.remove();\n      }\n    });\n    state.canvas.on('mousemove', function () {\n      state.tooltip.style('left', event.pageX + 'px').style('top', event.pageY + 'px').style('transform', \"translate(-\".concat(event.offsetX / state.width * 100, \"%, 21px)\")); // adjust horizontal position to not exceed canvas boundaries\n    }); // Reset focus by clicking on canvas\n\n    state.svg.on('click', function () {\n      return (state.onClick || _this.focusOnNode)(null);\n    }) // By default reset zoom when clicking on canvas\n    .on('mouseover', function () {\n      return state.onHover && state.onHover(null);\n    });\n  },\n  update: function update(state) {\n    var _this2 = this;\n\n    if (state.needsReparse) {\n      this._parseData();\n\n      state.needsReparse = false;\n    }\n\n    var maxRadius = Math.min(state.width, state.height) / 2;\n    state.radiusScale.range([maxRadius * .1, maxRadius]);\n    state.svg.style('width', state.width + 'px').style('height', state.height + 'px').attr('viewBox', \"\".concat(-state.width / 2, \" \").concat(-state.height / 2, \" \").concat(state.width, \" \").concat(state.height));\n    if (!state.layoutData) return;\n    var focusD = state.focusOnNode && state.focusOnNode.__dataNode.y0 >= 0 && state.focusOnNode.__dataNode || {\n      x0: 0,\n      x1: 1,\n      y0: 0,\n      y1: 1\n    };\n    var slice = state.canvas.selectAll('.slice').data(state.layoutData.filter(function (d) {\n      return (// Show only slices with a large enough angle and within the max levels\n        d.x1 >= focusD.x0 && d.x0 <= focusD.x1 && (d.x1 - d.x0) / (focusD.x1 - focusD.x0) > state.minSliceAngle / 360 && (!state.maxLevels || d.depth - (focusD.depth || (state.excludeRoot ? 1 : 0)) < state.maxLevels) && (d.y0 >= 0 || focusD.parent)\n      );\n    } // hide negative layers on top level\n    ), function (d) {\n      return d.id;\n    });\n    var nameOf = accessorFn(state.label);\n    var colorOf = accessorFn(state.color);\n    var transition$1 = transition().duration(TRANSITION_DURATION);\n    var levelYDelta = state.layoutData[0].y1 - state.layoutData[0].y0;\n    var maxY = Math.min(1, focusD.y0 + levelYDelta * Math.min(focusD.hasOwnProperty('height') ? focusD.height + 1 : Infinity, state.maxLevels || Infinity)); // Apply zoom\n\n    state.svg.transition(transition$1).tween('scale', function () {\n      var xd = interpolate(state.angleScale.domain(), [focusD.x0, focusD.x1]);\n      var yd = interpolate(state.radiusScale.domain(), [focusD.y0, maxY]);\n      return function (t) {\n        state.angleScale.domain(xd(t));\n        state.radiusScale.domain(yd(t));\n      };\n    }); // Exiting\n\n    var oldSlice = slice.exit().transition(transition$1).style('opacity', 0).remove();\n    oldSlice.select('path.main-arc').attrTween('d', function (d) {\n      return function () {\n        return state.arc(d);\n      };\n    });\n    oldSlice.select('path.hidden-arc').attrTween('d', function (d) {\n      return function () {\n        return middleArcLine(d);\n      };\n    }); // Entering\n\n    var newSlice = slice.enter().append('g').attr('class', 'slice').style('opacity', 0).on('click', function (d) {\n      event.stopPropagation();\n\n      (state.onClick || _this2.focusOnNode)(d.data);\n    }).on('mouseover', function (d) {\n      event.stopPropagation();\n      state.onHover && state.onHover(d.data);\n      state.tooltip.style('display', state.showTooltip(d.data, d) ? 'inline' : 'none');\n      state.tooltip.html(\"<div class=\\\"tooltip-title\\\">\".concat(state.tooltipTitle ? state.tooltipTitle(d.data, d) : getNodeStack(d).slice(state.excludeRoot ? 1 : 0).map(function (d) {\n        return nameOf(d.data);\n      }).join(' &rarr; '), \"</div>\").concat(state.tooltipContent(d.data, d)));\n    }).on('mouseout', function () {\n      state.tooltip.style('display', 'none');\n    });\n    newSlice.append('path').attr('class', 'main-arc').style('fill', function (d) {\n      return colorOf(d.data, d.parent);\n    });\n    newSlice.append('path').attr('class', 'hidden-arc').attr('id', function (d) {\n      return \"hidden-arc-\".concat(state.chartId, \"-\").concat(d.id);\n    });\n    var label = newSlice.append('text').attr('class', 'path-label'); // Add white contour\n\n    label.append('textPath').attr('class', 'text-contour').attr('startOffset', '50%').attr('xlink:href', function (d) {\n      return \"#hidden-arc-\".concat(state.chartId, \"-\").concat(d.id);\n    });\n    label.append('textPath').attr('class', 'text-stroke').attr('startOffset', '50%').attr('xlink:href', function (d) {\n      return \"#hidden-arc-\".concat(state.chartId, \"-\").concat(d.id);\n    }); // Entering + Updating\n\n    var allSlices = slice.merge(newSlice);\n    allSlices.style('opacity', 1);\n    allSlices.select('path.main-arc').transition(transition$1).attrTween('d', function (d) {\n      return function () {\n        return state.arc(d);\n      };\n    }).style('fill', function (d) {\n      return colorOf(d.data, d.parent);\n    });\n    allSlices.select('path.hidden-arc').transition(transition$1).attrTween('d', function (d) {\n      return function () {\n        return middleArcLine(d);\n      };\n    });\n    allSlices.select('.path-label').transition(transition$1).styleTween('display', function (d) {\n      return function () {\n        return state.showLabels && textFits(d) ? null : 'none';\n      };\n    }); // Ensure propagation of data to children\n\n    allSlices.selectAll('text.path-label').select('textPath.text-contour');\n    allSlices.selectAll('text.path-label').select('textPath.text-stroke');\n    allSlices.selectAll('text.path-label').selectAll('textPath').text(function (d) {\n      return nameOf(d.data);\n    }); //\n\n    function middleArcLine(d) {\n      var halfPi = Math.PI / 2;\n      var angles = [state.angleScale(d.x0) - halfPi, state.angleScale(d.x1) - halfPi];\n      var r = Math.max(0, (state.radiusScale(d.y0) + state.radiusScale(d.y1)) / 2);\n      if (!r || !(angles[1] - angles[0])) return '';\n      var middleAngle = (angles[1] + angles[0]) / 2;\n      var invertDirection = middleAngle > 0 && middleAngle < Math.PI; // On lower quadrants write text ccw\n\n      if (invertDirection) {\n        angles.reverse();\n      }\n\n      var path$1 = path();\n      path$1.arc(0, 0, r, angles[0], angles[1], invertDirection);\n      return path$1.toString();\n    }\n\n    function textFits(d) {\n      var deltaAngle = state.angleScale(d.x1) - state.angleScale(d.x0);\n      var r = Math.max(0, (state.radiusScale(d.y0) + state.radiusScale(d.y1)) / 2);\n      var perimeter = r * deltaAngle;\n      return nameOf(d.data).toString().length * CHAR_PX < perimeter;\n    }\n\n    function getNodeStack(d) {\n      var stack = [];\n      var curNode = d;\n\n      while (curNode) {\n        stack.unshift(curNode);\n        curNode = curNode.parent;\n      }\n\n      return stack;\n    }\n  }\n});\nexport default sunburst;","map":{"version":3,"sources":["/Users/laurenho/Desktop/teamtech2020/node_modules/sunburst-chart/dist/sunburst-chart.module.js"],"names":["select","event","scaleLinear","scaleSqrt","hierarchy","partition","arc","path","interpolate","transition","Kapsule","accessorFn","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","css_248z","TRANSITION_DURATION","CHAR_PX","sunburst","props","width","window","innerWidth","height","innerHeight","data","onChange","_","state","needsReparse","children","sort","label","_default","d","name","size","color","minSliceAngle","maxLevels","showLabels","tooltipContent","triggerUpdate","tooltipTitle","showTooltip","focusOnNode","initialised","moveStackToFront","__dataNode","elD","svg","selectAll","filter","each","parentNode","parent","excludeRoot","onClick","onHover","methods","_parseData","hierData","sum","padding","yScale","domain","y1","y0","descendants","forEach","i","id","layoutData","aliases","onNodeClick","init","domNode","_this","chartId","Math","round","random","radiusScale","angleScale","range","PI","clamp","startAngle","x0","endAngle","x1","innerRadius","max","outerRadius","el","append","attr","canvas","tooltip","addEventListener","e","target","remove","on","pageX","pageY","concat","offsetX","update","_this2","maxRadius","min","focusD","slice","depth","nameOf","colorOf","transition$1","duration","levelYDelta","maxY","hasOwnProperty","Infinity","tween","xd","yd","t","oldSlice","exit","attrTween","middleArcLine","newSlice","enter","stopPropagation","html","getNodeStack","map","join","allSlices","merge","styleTween","textFits","text","halfPi","angles","r","middleAngle","invertDirection","reverse","path$1","toString","deltaAngle","perimeter","length","stack","curNode","unshift"],"mappings":"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","sourcesContent":["import { select, event } from 'd3-selection';\nimport { scaleLinear, scaleSqrt } from 'd3-scale';\nimport { hierarchy, partition } from 'd3-hierarchy';\nimport { arc } from 'd3-shape';\nimport { path } from 'd3-path';\nimport { interpolate } from 'd3-interpolate';\nimport { transition } from 'd3-transition';\nimport Kapsule from 'kapsule';\nimport accessorFn from 'accessor-fn';\n\nfunction styleInject(css, ref) {\n  if (ref === void 0) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') {\n    return;\n  }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar css_248z = \".sunburst-viz .slice path {\\n  cursor: pointer;\\n}\\n\\n.sunburst-viz text {\\n  font-family: sans-serif;\\n  font-size: 12px;\\n  dominant-baseline: middle;\\n  text-anchor: middle;\\n  pointer-events: none;\\n  fill: #222;\\n}\\n\\n.sunburst-viz text .text-contour {\\n  fill: none;\\n  stroke: white;\\n  stroke-width: 5;\\n  stroke-linejoin: 'round';\\n}\\n\\n.sunburst-viz .main-arc {\\n  stroke: white;\\n  stroke-width: 1px;\\n  transition: opacity .4s;\\n}\\n\\n.sunburst-viz .main-arc:hover {\\n  opacity: 0.85;\\n  transition: opacity .05s;\\n}\\n\\n.sunburst-viz .hidden-arc {\\n  fill: none;\\n}\\n\\n.sunburst-tooltip {\\n  display: none;\\n  position: absolute;\\n  max-width: 320px;\\n  white-space: nowrap;\\n  padding: 5px;\\n  border-radius: 3px;\\n  font: 12px sans-serif;\\n  color: #eee;\\n  background: rgba(0,0,0,0.65);\\n  pointer-events: none;\\n}\\n\\n.sunburst-tooltip .tooltip-title {\\n  font-weight: bold;\\n  text-align: center;\\n  margin-bottom: 5px;\\n}\\n\";\nstyleInject(css_248z);\n\nvar TRANSITION_DURATION = 750;\nvar CHAR_PX = 6;\nvar sunburst = Kapsule({\n  props: {\n    width: {\n      \"default\": window.innerWidth\n    },\n    height: {\n      \"default\": window.innerHeight\n    },\n    data: {\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    children: {\n      \"default\": 'children',\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    sort: {\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    label: {\n      \"default\": function _default(d) {\n        return d.name;\n      }\n    },\n    size: {\n      \"default\": 'value',\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    color: {\n      \"default\": function _default(d) {\n        return 'lightgrey';\n      }\n    },\n    minSliceAngle: {\n      \"default\": .2\n    },\n    maxLevels: {},\n    showLabels: {\n      \"default\": true\n    },\n    tooltipContent: {\n      \"default\": function _default(d) {\n        return '';\n      },\n      triggerUpdate: false\n    },\n    tooltipTitle: {\n      \"default\": null,\n      triggerUpdate: false\n    },\n    showTooltip: {\n      \"default\": function _default(d) {\n        return true;\n      },\n      triggerUpdate: false\n    },\n    focusOnNode: {\n      onChange: function onChange(d, state) {\n        if (d && state.initialised) {\n          moveStackToFront(d.__dataNode);\n        }\n\n        function moveStackToFront(elD) {\n          state.svg.selectAll('.slice').filter(function (d) {\n            return d === elD;\n          }).each(function (d) {\n            this.parentNode.appendChild(this);\n\n            if (d.parent) {\n              moveStackToFront(d.parent);\n            }\n          });\n        }\n      }\n    },\n    excludeRoot: {\n      \"default\": false,\n      onChange: function onChange(_, state) {\n        state.needsReparse = true;\n      }\n    },\n    onClick: {\n      triggerUpdate: false\n    },\n    onHover: {\n      triggerUpdate: false\n    }\n  },\n  methods: {\n    _parseData: function _parseData(state) {\n      if (state.data) {\n        var hierData = hierarchy(state.data, accessorFn(state.children)).sum(accessorFn(state.size));\n\n        if (state.sort) {\n          hierData.sort(state.sort);\n        }\n\n        partition().padding(0)(hierData);\n\n        if (state.excludeRoot) {\n          // re-scale y values if excluding root\n          var yScale = scaleLinear().domain([hierData.y1 - hierData.y0, 1]);\n          hierData.descendants().forEach(function (d) {\n            d.y0 = yScale(d.y0);\n            d.y1 = yScale(d.y1);\n          });\n        }\n\n        hierData.descendants().forEach(function (d, i) {\n          d.id = i; // Mark each node with a unique ID\n\n          d.data.__dataNode = d; // Dual-link data nodes\n        });\n        state.layoutData = hierData.descendants();\n      }\n    }\n  },\n  aliases: {\n    onNodeClick: 'onClick'\n  },\n  init: function init(domNode, state) {\n    var _this = this;\n\n    state.chartId = Math.round(Math.random() * 1e12); // Unique ID for DOM elems\n\n    state.radiusScale = scaleSqrt();\n    state.angleScale = scaleLinear().domain([0, 10]) // For initial build-in animation\n    .range([0, 2 * Math.PI]).clamp(true);\n    state.arc = arc().startAngle(function (d) {\n      return state.angleScale(d.x0);\n    }).endAngle(function (d) {\n      return state.angleScale(d.x1);\n    }).innerRadius(function (d) {\n      return Math.max(0, state.radiusScale(d.y0));\n    }).outerRadius(function (d) {\n      return Math.max(0, state.radiusScale(d.y1));\n    });\n    var el = select(domNode).append('div').attr('class', 'sunburst-viz');\n    state.svg = el.append('svg');\n    state.canvas = state.svg.append('g'); // tooltips\n\n    state.tooltip = select('body').append('div').attr('class', 'sunburst-tooltip'); // tooltip cleanup on unmount\n\n    domNode.addEventListener('DOMNodeRemoved', function (e) {\n      if (e.target === this) {\n        state.tooltip.remove();\n      }\n    });\n    state.canvas.on('mousemove', function () {\n      state.tooltip.style('left', event.pageX + 'px').style('top', event.pageY + 'px').style('transform', \"translate(-\".concat(event.offsetX / state.width * 100, \"%, 21px)\")); // adjust horizontal position to not exceed canvas boundaries\n    }); // Reset focus by clicking on canvas\n\n    state.svg.on('click', function () {\n      return (state.onClick || _this.focusOnNode)(null);\n    }) // By default reset zoom when clicking on canvas\n    .on('mouseover', function () {\n      return state.onHover && state.onHover(null);\n    });\n  },\n  update: function update(state) {\n    var _this2 = this;\n\n    if (state.needsReparse) {\n      this._parseData();\n\n      state.needsReparse = false;\n    }\n\n    var maxRadius = Math.min(state.width, state.height) / 2;\n    state.radiusScale.range([maxRadius * .1, maxRadius]);\n    state.svg.style('width', state.width + 'px').style('height', state.height + 'px').attr('viewBox', \"\".concat(-state.width / 2, \" \").concat(-state.height / 2, \" \").concat(state.width, \" \").concat(state.height));\n    if (!state.layoutData) return;\n    var focusD = state.focusOnNode && state.focusOnNode.__dataNode.y0 >= 0 && state.focusOnNode.__dataNode || {\n      x0: 0,\n      x1: 1,\n      y0: 0,\n      y1: 1\n    };\n    var slice = state.canvas.selectAll('.slice').data(state.layoutData.filter(function (d) {\n      return (// Show only slices with a large enough angle and within the max levels\n        d.x1 >= focusD.x0 && d.x0 <= focusD.x1 && (d.x1 - d.x0) / (focusD.x1 - focusD.x0) > state.minSliceAngle / 360 && (!state.maxLevels || d.depth - (focusD.depth || (state.excludeRoot ? 1 : 0)) < state.maxLevels) && (d.y0 >= 0 || focusD.parent)\n      );\n    } // hide negative layers on top level\n    ), function (d) {\n      return d.id;\n    });\n    var nameOf = accessorFn(state.label);\n    var colorOf = accessorFn(state.color);\n    var transition$1 = transition().duration(TRANSITION_DURATION);\n    var levelYDelta = state.layoutData[0].y1 - state.layoutData[0].y0;\n    var maxY = Math.min(1, focusD.y0 + levelYDelta * Math.min(focusD.hasOwnProperty('height') ? focusD.height + 1 : Infinity, state.maxLevels || Infinity)); // Apply zoom\n\n    state.svg.transition(transition$1).tween('scale', function () {\n      var xd = interpolate(state.angleScale.domain(), [focusD.x0, focusD.x1]);\n      var yd = interpolate(state.radiusScale.domain(), [focusD.y0, maxY]);\n      return function (t) {\n        state.angleScale.domain(xd(t));\n        state.radiusScale.domain(yd(t));\n      };\n    }); // Exiting\n\n    var oldSlice = slice.exit().transition(transition$1).style('opacity', 0).remove();\n    oldSlice.select('path.main-arc').attrTween('d', function (d) {\n      return function () {\n        return state.arc(d);\n      };\n    });\n    oldSlice.select('path.hidden-arc').attrTween('d', function (d) {\n      return function () {\n        return middleArcLine(d);\n      };\n    }); // Entering\n\n    var newSlice = slice.enter().append('g').attr('class', 'slice').style('opacity', 0).on('click', function (d) {\n      event.stopPropagation();\n\n      (state.onClick || _this2.focusOnNode)(d.data);\n    }).on('mouseover', function (d) {\n      event.stopPropagation();\n      state.onHover && state.onHover(d.data);\n      state.tooltip.style('display', state.showTooltip(d.data, d) ? 'inline' : 'none');\n      state.tooltip.html(\"<div class=\\\"tooltip-title\\\">\".concat(state.tooltipTitle ? state.tooltipTitle(d.data, d) : getNodeStack(d).slice(state.excludeRoot ? 1 : 0).map(function (d) {\n        return nameOf(d.data);\n      }).join(' &rarr; '), \"</div>\").concat(state.tooltipContent(d.data, d)));\n    }).on('mouseout', function () {\n      state.tooltip.style('display', 'none');\n    });\n    newSlice.append('path').attr('class', 'main-arc').style('fill', function (d) {\n      return colorOf(d.data, d.parent);\n    });\n    newSlice.append('path').attr('class', 'hidden-arc').attr('id', function (d) {\n      return \"hidden-arc-\".concat(state.chartId, \"-\").concat(d.id);\n    });\n    var label = newSlice.append('text').attr('class', 'path-label'); // Add white contour\n\n    label.append('textPath').attr('class', 'text-contour').attr('startOffset', '50%').attr('xlink:href', function (d) {\n      return \"#hidden-arc-\".concat(state.chartId, \"-\").concat(d.id);\n    });\n    label.append('textPath').attr('class', 'text-stroke').attr('startOffset', '50%').attr('xlink:href', function (d) {\n      return \"#hidden-arc-\".concat(state.chartId, \"-\").concat(d.id);\n    }); // Entering + Updating\n\n    var allSlices = slice.merge(newSlice);\n    allSlices.style('opacity', 1);\n    allSlices.select('path.main-arc').transition(transition$1).attrTween('d', function (d) {\n      return function () {\n        return state.arc(d);\n      };\n    }).style('fill', function (d) {\n      return colorOf(d.data, d.parent);\n    });\n    allSlices.select('path.hidden-arc').transition(transition$1).attrTween('d', function (d) {\n      return function () {\n        return middleArcLine(d);\n      };\n    });\n    allSlices.select('.path-label').transition(transition$1).styleTween('display', function (d) {\n      return function () {\n        return state.showLabels && textFits(d) ? null : 'none';\n      };\n    }); // Ensure propagation of data to children\n\n    allSlices.selectAll('text.path-label').select('textPath.text-contour');\n    allSlices.selectAll('text.path-label').select('textPath.text-stroke');\n    allSlices.selectAll('text.path-label').selectAll('textPath').text(function (d) {\n      return nameOf(d.data);\n    }); //\n\n    function middleArcLine(d) {\n      var halfPi = Math.PI / 2;\n      var angles = [state.angleScale(d.x0) - halfPi, state.angleScale(d.x1) - halfPi];\n      var r = Math.max(0, (state.radiusScale(d.y0) + state.radiusScale(d.y1)) / 2);\n      if (!r || !(angles[1] - angles[0])) return '';\n      var middleAngle = (angles[1] + angles[0]) / 2;\n      var invertDirection = middleAngle > 0 && middleAngle < Math.PI; // On lower quadrants write text ccw\n\n      if (invertDirection) {\n        angles.reverse();\n      }\n\n      var path$1 = path();\n      path$1.arc(0, 0, r, angles[0], angles[1], invertDirection);\n      return path$1.toString();\n    }\n\n    function textFits(d) {\n      var deltaAngle = state.angleScale(d.x1) - state.angleScale(d.x0);\n      var r = Math.max(0, (state.radiusScale(d.y0) + state.radiusScale(d.y1)) / 2);\n      var perimeter = r * deltaAngle;\n      return nameOf(d.data).toString().length * CHAR_PX < perimeter;\n    }\n\n    function getNodeStack(d) {\n      var stack = [];\n      var curNode = d;\n\n      while (curNode) {\n        stack.unshift(curNode);\n        curNode = curNode.parent;\n      }\n\n      return stack;\n    }\n  }\n});\n\nexport default sunburst;\n"]},"metadata":{},"sourceType":"module"}